"0","library(dplyr)"
"0","metric_plot <- function(df, dfsum, metric, title, xlab, ylab, co = NULL){"
"0","  xmin = min(dplyr::filter(male_metrics, Metric == metric)$CV, dplyr::filter(female_metrics, Metric == metric)$CV)"
"0","  xmax = max(dplyr::filter(male_metrics, Metric == metric)$CV, dplyr::filter(female_metrics, Metric == metric)$CV)"
"0","  ymin = min(dplyr::filter(male_metrics, Metric == metric)$Test_error, dplyr::filter(female_metrics, Metric == metric)$Test_error)"
"0","  ymax = max(dplyr::filter(male_metrics, Metric == metric)$Test_error, dplyr::filter(female_metrics, Metric == metric)$Test_error)"
"0","  "
"0","  if(is.null(co)){"
"0","    df %>% "
"0","      dplyr::filter(Metric == metric) %>% "
"0","    ggplot(aes(CV, Test_error, color = Model)) + "
"0","    geom_label_repel(data = dfsum %>% dplyr::filter(Metric == metric), aes(x = Mean_CV, y = Mean_TE, label = Model), size = 5, alpha = 1) +"
"0","    geom_abline(slope = 1, linetype = 2, alpha = 0.5) +"
"0","    geom_point() + "
"0","    theme_tomas(base_size = 15) + "
"0","    theme(legend.position = 'none', plot.title = element_text(size = 20),"
"0","          axis.line = element_line(size = 1, color = 'black'), "
"0","          axis.ticks = element_line(size = 1, color = 'black'), "
"0","          axis.text = element_text(color = 'black')) + "
"0","    labs(title = title, y = ylab, x = xlab) +"
"0","    xlim(xmin, xmax) + ylim(ymin, ymax) "
"0","  }"
"0","  else{"
"0","    df %>% "
"0","      dplyr::filter(Metric == metric) %>% "
"0","    ggplot(aes(CV, Test_error, color = Model)) + "
"0","    geom_label_repel(data = dfsum %>% dplyr::filter(Metric == metric), aes(x = Mean_CV, y = Mean_TE, label = Model), size = 5, alpha = 1, fill = co[1], color = co[2]) +"
"0","    geom_abline(slope = 1, linetype = 2, alpha = 0.5, color = co[2]) +"
"0","    geom_point() + "
"0","    theme_tomas(base_size = 15) + "
"0","    theme(legend.position = 'none', plot.title = element_text(size = 20),"
"0","          plot.background = element_rect(fill = co[1], color = co[1]), "
"0","          panel.background = element_rect(fill = co[1], color = co[1]), "
"0","          axis.line = element_line(color = co[2], size = 1), "
"0","          axis.ticks = element_line(size = 1, color = co[2]), "
"0","          axis.text = element_text(color = co[2]), "
"0","          axis.title = element_text(color = co[2])) + "
"0","    labs(title = title, y = ylab, x = xlab) +"
"0","    xlim(xmin, xmax) + ylim(ymin, ymax)"
"0","  }"
"0","}"
